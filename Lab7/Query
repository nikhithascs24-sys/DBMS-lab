(i) Find the pnames of parts for which there is some supplier
select distinct p.pname
from part p
join catalog c on p.pid = c.pid;
 
(ii) Find the snames of suppliers who supply every part
select s.sname
from supplier s
where not exists (
   select p.pid
   from part p
   where p.pid not in (
       select c.pid
       from catalog c
       where c.sid = s.sid
   )
);
 
(iii) Find the snames of suppliers who supply every red part
select s.sname
from supplier s
where not exists (
   select p.pid
   from part p
   where p.color = 'red'
   and p.pid not in (
       select c.pid
       from catalog c
       where c.sid = s.sid
   )
);

(iv) Find the pnames of parts supplied by acme widget and by no one else
select p.pname
from part p
join catalog c on p.pid = c.pid
join supplier s on s.sid = c.sid
where s.sname = 'acme widget'
and p.pid not in (
   select c2.pid
   from catalog c2
   join supplier s2 on s2.sid = c2.sid
   where s2.sname <> 'acme widget'
);
v) Find the sids of suppliers who charge more for some part than the average cost of that part
select distinct c.sid
from catalog c
where c.cost > (
   select avg(c2.cost)
   from catalog c2
   where c2.pid = c.pid
);
vi) For each part, find the sname of the supplier who charges the most for that part
select p.pid, p.pname, s.sname, c.cost
from part p
join catalog c on p.pid = c.pid
join supplier s on s.sid = c.sid
where c.cost = (
   select max(c2.cost)
   from catalog c2
   where c2.pid = p.pid
);

 
